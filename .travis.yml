---
#
# Ansible managed
#
language: python

python:
  - "3.8"

services:
  - docker

env:
  global:
    namespace="robertdebock"
  matrix:
    - image="amazonlinux" tag="1"
    - image="centos" tag="7"
    - image="centos" tag="latest"
    - image="debian" tag="latest"
    - image="debian" tag="bullseye"
    - image="fedora" tag="31"
    - image="fedora" tag="latest"
    - image="opensuse" tag="latest"
    - image="ubuntu" tag="latest"
    - image="ubuntu" tag="bionic"
    - image="ubuntu" tag="xenial"

cache:
  - pip

install:
  - pip install --upgrade pip
  - pip install tox

script:
  - function retry { counter=0 ; until "$@" ; do exit=$? ; counter=$(($counter + 1)) ; if [ $counter -ge 3 ] ; then return $exit ; fi ; done ; return 0; } ; retry tox --parallel all

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
  slack: "lttAGypcw2oTXYZGeccKjvhwoS18mQt6cPZMlM8IWmDNkZwt0Te0RvQREmyuTESIghEIxcz44x+FQUa0fQIrL1GGcu4teBZBaxPsLDEzv2O7YLJ0ZiIbMwLJDgTGNj9CNseZhTmzremDYChM0bAyINjJWdAl15B0uGu2p3Ug9mGQ7klqE0jxkfj1wFmEPKuPWNmfle1G9ZtPjzK3vGp6oiSx+O73Sr82ry1+OmjCvLWpNJS95Qm8IPvHgR9MPb0JfDEmeSio6gJ2EA03x8VM98xMHY8c0uAKSsf3j4cKAl9qo+8pPdpQ78pM2PvdljhVC6GvLyL66lkF4om8WIpBS/urQ42aXfphxuoLirv3G4qbU5Mf7PUBKs7tv56cC44sCfFaywaywLZ3IdAvO+ZGSZWFyPAym0zY+IlCGtLJ4+yhEYIB710DJSrrJdXpWvkjWFKzkvkdH5IIRQJZr2F/oXz/04dFiZpksSoEHA3jZI7rhwK0M2CJD1uGnZMIbtGEXdYWCf1ohC4i5+pwT4nvCl36ZM4n8dPWlkZVXFbSuMWKLbojh9vqTsUZTa6WC6TK8MHy9y+P55daDLsZmizr3DCvTwECH/MOmYTx9d4J0f7uYgkvhTzYZww5KKaDBAESJx6ja3X3D5ZHIEjdHQ5zbCRD//aVUxV6Y9Ltr0wQWNM="
  email: false
